Bootstrap: library
From: ubuntu

%files
    3plex/local/bin /3plex/local/bin
    3plex/local/config /3plex/local/config
    3plex/local/envs/3plex.yaml /3plex/local/envs/3plex.yaml
    3plex/local/rules /3plex/local/rules

%post
    apt-get update && apt-get install -y curl cmake gcc build-essential libgomp1 libboost-all-dev vim ssh-client wget unzip python3 python3-yaml git gawk && apt-get clean
    git clone https://github.com/UDC-GAC/pato
    cd pato && make gnu -
    mkdir /opt/bin/
    mv /pato/target/gnu/pato.release /opt/bin/pato
    mkdir mamba && export MAMBA_ROOT_PREFIX=/3plex/mamba && cd / && curl -Ls https://micro.mamba.pm/api/micromamba/linux-64/latest | tar -xvj bin/micromamba && eval "$(./bin/micromamba shell hook -s posix)" && micromamba shell init --shell bash && ./bin/micromamba shell init -s bash -p ~/micromamba
    export MAMBA_ROOT_PREFIX=/mamba && /bin/bash && eval "$(micromamba shell hook --shell bash)" && source ~/.bashrc && micromamba activate && micromamba env create -y -f /3plex/local/envs/3plex.yaml 

